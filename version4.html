<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@0.4.2/dist/mindar.prod.js"></script>
	<script
      type="application/javascript"
      src="https://hammerjs.github.io/dist/hammer.min.js"
    ></script>
	<script>
		AFRAME.registerComponent("registerevents", {
        init: function () {
          var element = document.querySelector("body");
          this.marker = document.querySelector("a-marker");
          var model = document.getElementById("bottle");

          this.marker.addEventListener("markerFound", () => {
            // alert("Marker found");
          });
          this.marker.addEventListener("markerLost", () => {
            // alert("Marker Lost");
          });

          var hammertime = new Hammer(element);
          var pinch = new Hammer.Pinch(); // Pinch is not by default in the recognisers
          hammertime.add(pinch); // add it to the Manager instance

          hammertime.on("pan", (ev) => {
            let rotation = model.getAttribute("rotation");
            switch (ev.direction) {
              case 2:
                rotation.y = rotation.y + 6;
                break;
              case 4:
                rotation.y = rotation.y - 6;
                break;
              case 8:
                rotation.x = rotation.x + 6;
                break;
              case 16:
                rotation.x = rotation.x - 6;
                break;
              default:
                break;
            }
            model.setAttribute("rotation", rotation);
          });

          hammertime.on("pinch", (ev) => {
            let scale = {
              x: ev.scale * 0.05,
              y: ev.scale * 0.05,
              z: ev.scale * 0.05,
            };
            // alert(scale);
            model.setAttribute("scale", scale);
          });
        },
      });
	</script>
  </head>
  <body>
    <a-scene 
	  mindar="imageTargetSrc: ./targets.mind; showStats: true;" 
	  color-space="sRGB" 
	  renderer="colorManagement: true, physicallyCorrectLights" 
	  vr-mode-ui="enabled: false" 
	  device-orientation-permission-ui="enabled: false"
	>
      <a-assets>
		<video crossorigin="anonymous" id="promotional" loop="false" src="video.mp4" type="video/mp4" preload="auto"  playsinline>
    	<a-asset-item
		  id="scene1"
		  src="scene.gltf"
		>
      </a-assets>
	  <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
      
      <a-entity mindar-image-target="targetIndex: 0" id="bottle">
		<a-plane id="btn"  position='0 1 0' scale="1 0.5 0.5" rotation="0 0 0" material='transparent:true;alphaTest:0;src:#promotional'></a-plane>
		<a-gltf-model  rotation="0 0 0 " position="0 0 0.1" scale="0.007 0.005 0.005" src="#scene1">
      </a-entity>
    </a-scene>
	
  </body>
</html>


